webpackJsonp([9],{"6pLL":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("Xxa5"),a=n.n(o),i=n("exGp"),r=n.n(i),s=n("Dd8w"),c=n.n(s),u=n("NYxO"),l={name:"curTask",components:{PageComp:n("B1va").a},computed:c()({data:{get:function(){return this.$store.state.onGoing},set:function(t){this.$store.commit("changeOngoing",t)}},type:{get:function(){return this.$store.state.onGoingType},set:function(t){this.$store.commit("changeOngoingType",t)}},cols:function(){var t=[{title:"用户",key:"uid"},{title:"部门",key:"uniqueId"},{title:"开始时间",key:"startTime"},{title:"持续时间",key:"timeStr"},{title:"操作",slot:"action",align:"center"}];return"1"!==this.type&&t.unshift({title:"业务类型",key:"typeStr"}),t}},Object(u.b)(["contentHeight","treeHeight","onGoingStart","onGoingEnd","color"])),mounted:function(){this.$store.commit("changeName","当前业务管理"),this.update(),this.$store.commit("changeFullscreen",!1)},methods:{update:function(){this.getOnline(),this.getAudioOnGoing(),this.getVideoOnGoing()},getVideoOnGoing:function(){var t=this;this.$axios({method:"get",headers:{Authorization:"Bearer "+sessionStorage.getItem("token")},url:this.$host+"/index/ongoing",params:{type:3}}).then(function(e){console.log(e),t.data[3]=e.data,t.data[3].map(function(t){switch(t.type){case 1:t.typeStr="视频通话";break;case 2:t.typeStr="视频回传";break;case 3:t.typeStr="视频点名";break;case 4:t.typeStr="视频会商"}}),t.reOrder(t.data[3])}).catch(function(t){console.log(t)})},getAudioOnGoing:function(){var t=this;this.$axios({method:"get",headers:{Authorization:"Bearer "+sessionStorage.getItem("token")},url:this.$host+"/index/ongoing",params:{type:2}}).then(function(e){console.log(e),t.data[2]=e.data,t.data[2].map(function(t){1===t.type?t.typeStr="个人语音":t.typeStr="群组语音"}),t.reOrder(t.data[2])}).catch(function(t){console.log(t)})},getOnline:function(){var t=this;this.$axios({method:"get",headers:{Authorization:"Bearer "+sessionStorage.getItem("token")},url:this.$host+"/index/ongoing",params:{type:1}}).then(function(e){console.log(e),t.data[1]=e.data,t.reOrder(t.data[1])}).catch(function(t){console.log(t)})},remove:function(t){this.data[this.type].splice(parseInt(t)+parseInt(this.onGoingStart),1)},interuptQuery:function(t,e){var n=this;this.$axios({method:"get",headers:{Authorization:"Bearer "+sessionStorage.getItem("token")},url:this.$host+"/index/interruput",params:{type:this.type,flag:e.type,uid:e.uid}}).then(function(e){console.log(e),n.remove(t)}).catch(function(t){console.log(t)})},reOrder:function(t){var e=this;return r()(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.map(function(t){var e=t.startTime.split(" "),n=e[0];n=n.split("-").map(function(t){return parseInt(t)});var o=e[1];o=o.split(":").map(function(t){return parseInt(t)});var a=new Date;a.setFullYear(n[0]),a.setMonth(n[1]-1),a.setDate(n[2]),a.setHours(o[0]),a.setMinutes(o[1]),a.setSeconds(o[2]);var i=((Date.parse((new Date).toString())-Date.parse(a.toString()))/1e3).toFixed(0),r=void 0;if(i>3600){var s=(i/3600).toFixed(0);r=s>24?Math.floor(s/24)+"天"+s%24+"小时":s+"小时"+Math.floor(i/60)%60+"分钟"}else r=i>60?Math.floor(i/60)+"分钟"+i%60+"秒":i+"秒";t.lastTime=i,t.timeStr=r});case 2:return n.next=4,t.sort(e.sortData);case 4:case"end":return n.stop()}},n,e)}))()},sortData:function(t,e){return e.lastTime-t.lastTime}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Content",{style:{padding:"10px 20px 10px",minHeight:t.contentHeight+"px",background:t.color.content}},[n("Row",{style:{color:t.color.contentHighlight,padding:"5px 0"}},[t._v("请选择您想查看的业务：\n    "),n("Select",{staticStyle:{width:"auto"},attrs:{placeholder:"选择想查看的业务"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[n("Option",{attrs:{value:"1"}},[t._v("当前在线")]),t._v(" "),n("Option",{attrs:{value:"2"}},[t._v("语音业务")]),t._v(" "),n("Option",{attrs:{value:"3"}},[t._v("视频业务")])],1)],1),t._v(" "),n("Table",{attrs:{columns:t.cols,data:t.data[t.type].slice(t.onGoingStart,t.onGoingEnd)},scopedSlots:t._u([{key:"action",fn:function(e){var o=e.row,a=e.index;return[n("Button",{style:{background:t.color.content,color:t.color.contentText},attrs:{size:"small"},on:{click:function(e){return t.interuptQuery(a,o)}}},[t._v("终止业务")])]}}])}),t._v(" "),n("PageComp")],1)},staticRenderFns:[]},h=n("VU/8")(l,p,!1,null,null,null);e.default=h.exports}});