webpackJsonp([4],{"73Di":function(e,t){},Svvl:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Dd8w"),a=n.n(i),r=n("NYxO"),o=n("dXKt"),s=n("FVPG"),u=n("FZWW"),c={components:{GraphComp:n("TIVH").a,FullButtons:u.a,SearchBoxes:s.a,DeptList:o.a},mounted:function(){this.$store.commit("changeName","部门统计图表"),0===this.deptTotal&&this.$refs.search.newQuery()},computed:a()({},Object(r.d)(["depShow","deptData","fullscreen","searchShow"]),Object(r.b)(["display","contentHeight","deptStart","deptEnd","deptTotal","color"]))},h={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Content",{style:{padding:"10px 20px 10px",minHeight:e.contentHeight+"px",background:e.color.content}},[n("FullButtons"),e._v(" "),n("Row",[n("Col",{directives:[{name:"show",rawName:"v-show",value:e.depShow,expression:"depShow"}],staticClass:"noPrint",attrs:{lg:7}},[n("DeptList")],1),e._v(" "),n("Col",{attrs:{lg:e.display,id:"mainPage"}},[n("SearchBoxes",{directives:[{name:"show",rawName:"v-show",value:!e.fullscreen||e.searchShow,expression:"!fullscreen||searchShow"}],ref:"search"}),e._v(" "),n("GraphComp")],1)],1)],1)},staticRenderFns:[]},d=n("VU/8")(c,h,!1,null,null,null);t.default=d.exports},TIVH:function(e,t,n){"use strict";var i=n("Xxa5"),a=n.n(i),r=n("exGp"),o=n.n(r),s=n("mvHQ"),u=n.n(s),c=n("gRE1"),h=n.n(c),d=n("fZjL"),l=n.n(d),p=n("Dd8w"),m=n.n(p),x=n("NYxO"),f={name:"graphComp",data:function(){return{pieChart:"",lineChart:"",myChart:"",deptStart:0,currentPage:1,userStart:0,nameList:{all:["通话","视频业务","一键告警","照片回传","即时消息","临时组创建","在线时长","里程"],video_count:["视频业务总计","通话次数","回传次数","点名次数","会商次数","总时长"],audio_count:["通话总次数","群组通话次数","个人通话次数","群组通话时长","个人通话时长"],im_count:["即时消息总次数","群组消息次数","个人消息次数"]},pieNameList:{all:["通话","视频业务","一键告警","照片回传","即时消息","临时组创建"],video_count:["通话次数","回传次数","点名次数","会商次数"],audio_count:["群组通话次数","个人通话次数"],im_count:["群组消息次数","个人消息次数"]},legendList:{all:{"通话":!1,"视频业务":!1,"一键告警":!1,"照片回传":!1,"即时消息":!1,"临时组创建":!1,"在线时长":!1,"里程":!1},video_count:{"视频业务总计":!1,"通话次数":!1,"回传次数":!1,"点名次数":!1,"会商次数":!1,"总时长":!1},audio_count:{"通话总次数":!1,"群组通话次数":!1,"个人通话次数":!1,"群组通话时长":!1,"个人通话时长":!1},im_count:{"即时消息总次数":!1,"群组消息次数":!1,"个人消息次数":!1}},yAxisList:[{name:"业务次数",type:"value",scale:!0,splitLine:!1,position:"left",axisLabel:{formatter:"{value}次"}},{name:"在线时长",type:"value",scale:!0,splitLine:!1,position:"right",axisLabel:{formatter:"{value}小时"}},{name:"里程",type:"value",scale:!0,splitLine:!1,position:"left",offset:50,axisLabel:{formatter:"{value}千米"}}],pieDimensions:{all:["talkCount","videoAllCount","sosCount","photoUploadCount","imCount","tmpGroupCount"],video_count:["videoCallCount","videoUploadCount","videoRollcallCount","videoConfCount"],audio_count:["groupTalkCount","individualTalkCount"],im_count:["individualImCount","groupImCount"]}}},computed:m()({bar:function(){return"bar"===this.graphType},line:function(){return"line"===this.graphType},pie:function(){return"pie"===this.graphType},index:function(){return this.currentPage-1},graphType:{get:function(){return this.$store.state.graphType},set:function(e){this.$store.commit("changeGraph",e)}},allCheck:{get:function(){return this.$store.state.allCheck},set:function(e){this.$store.commit("changeAllCheck",e)}},data:function(){return"部"===this.pageName[0]?this.deptData.slice(this.deptStart,this.deptEnd):this.userData.slice(this.userStart,this.userEnd)},objectList:function(){return"dept"===this.pageType?this.deptList:this.userList},timeData:function(){var e=this,t=void 0;if(!(t="dept"===this.pageType?this.deptTimeData:this.userTimeData)||0===l()(t).length||this.objectList.length<=this.index||!t[this.objectList[this.index]])return{};t=t[this.objectList[this.index]];var n=h()(t).map(function(e,t){return e.onlineDuration=(e.onlineDuration/3600).toFixed(2),e.videoDuration=(e.videoDuration/3600).toFixed(2),e.groupTalkDuration=(e.groupTalkDuration/3600).toFixed(2),e.individualTalkDuration=(e.individualTalkDuration/3600).toFixed(2),e.mileage=(e.mileage/1e3).toFixed(2),e});return{xAxis:l()(t).map(function(t){return e.dateReform(t)}),values:n}},deptEnd:function(){return Math.min(100,this.deptTotal)},userEnd:function(){return Math.min(100,this.userTotal)},yAxis:function(){for(var e=this.selectType,t=JSON.parse(u()(this.yAxisList)),n=0;n<3;n++)t[n].axisLine={lineStyle:{color:this.color.contentText}};return"all"===e?t:"im_count"===e?t[0]:t.slice(0,2)},xAxis:function(){return"dept"===this.pageType?this.data.map(function(e){return e.deptName}):this.data.map(function(e){return e.name+" ("+e.uid+")"})},dataZoom:function(){return this.data.length>1?[{type:"inside",maxValueSpan:9},{type:"slider",startValue:this.index,maxValueSpan:9,borderColor:"none",labelFormatter:"",top:"98%"}]:"首页"!==this.pageName?[]:void 0},barOption:function(){var e=this.selectType,t=this,n=void 0,i={selected:this.legendList[e],textStyle:{color:this.color.contentText}};return"首页"===this.pageName?(n=this.mainSubData,i.show=!1):n=this.data,{legend:i,tooltip:{},grid:{right:100,left:150,bottom:100},dataZoom:this.dataZoom,xAxis:{type:"category",axisLine:{lineStyle:{color:this.color.contentText}},data:this.xAxis,axisLabel:{formatter:function(e){return t.formatText(e.split(" ")[0])}}},yAxis:this.yAxis,series:this.formSeries(n)[e]}},indexName:function(){var e=void 0;if(this.data.length>this.index){var t=this.data[this.index];e="部"===this.pageName[0]?t.deptName:t.name+"("+t.uid+")"}else e="";return e},pieOption:function(){for(var e=this.selectType,t=[],n=this.pieDimensions[e],i=this.pieNameList[e],a=this.data,r=0;r<n.length;r++){var o=0;a.length>this.index&&(o=a[this.index][n[r]]),t.push({name:i[r],value:o})}return{title:{text:this.indexName+"\n各业务使用比例",bottom:0,textStyle:{color:this.color.contentText}},legend:{selected:this.legendList[e],orient:"vertical",right:0,top:"20%",textStyle:{color:this.color.contentText}},tooltip:{formatter:"{b}:{c}次 {d}%"},grid:{right:100,left:150,bottom:150},series:{type:"pie",data:t}}},lineOption:function(){var e=[];this.timeData.xAxis&&(e=this.timeData.xAxis);var t=void 0,n=this.selectType;return t=this.timeData.values?this.formSeries(this.timeData.values)[n]:this.formSeries([])[n],{title:{text:this.indexName+"\n各业务使用时间趋势",bottom:0,textStyle:{color:this.color.contentText}},legend:{selected:this.legendList[n],textStyle:{color:this.color.contentText}},tooltip:{},grid:{right:100,left:150,bottom:100},dataZoom:{type:"inside"},xAxis:{type:"category",data:e,axisTick:{show:!1},axisLine:{lineStyle:{color:this.color.contentText}}},yAxis:this.yAxis,series:t}},total:function(){return"dept"===this.pageType?this.deptTotal:this.userTotal},checkedGroup:{get:function(){return this.$store.state.checkedGroup},set:function(e){this.$store.commit("changeChecked",e)}}},Object(x.b)(["userTotal","deptTotal","graphHeight","pageType","deptList","pageType","userList","color"]),Object(x.d)(["searchShow","fullscreen","sub","selectType","pageName","deptData","userData","depShow","checkboxGroup","deptTimeData","userTimeData","loading","timeLoading"])),mounted:function(){var e=this;this.myChart=this.$echarts.init(document.getElementById("chart")),this.pieChart=this.$echarts.init(document.getElementById("pieChart")),this.lineChart=this.$echarts.init(document.getElementById("lineChart")),window.addEventListener("resize",function(){return e.graphResize()},!1)},watch:{data:function(){this.currentPage=1,this.drawGraph()},selectType:function(){this.drawGraph()},graphHeight:function(){this.graphResize()},depShow:function(){this.graphResize()},searchShow:function(){this.graphResize()},currentPage:function(){this.drawGraph()},pageName:function(){this.drawGraph()},allCheck:function(){this.drawGraph()},timeData:function(){this.drawGraph()},loading:function(e){e&&(this.myChart.showLoading({text:"正在加载数据"}),this.pieChart.showLoading({text:"正在加载数据"}))},timeLoading:function(e){},graphType:function(){this.drawGraph()}},methods:{formatText:function(e){var t="",n=e.length,i=Math.ceil(n/3);if(n>3)for(var a=0;a<i;a++){var r=3*a,o=r+3;t+=a===i-1?e.substring(r,n):e.substring(r,o)+"\n"}else t=e;return t},drawGraph:function(){var e=this;return o()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,t.next=3,e.generateLegend();case 3:if(!e.bar){t.next=11;break}return e.myChart.showLoading({text:"正在加载数据"}),t.next=7,e.myChart.setOption(e.barOption,!0);case 7:e.myChart.on("legendselectchanged",function(e){n.generateIndex(e.selected)}),window.onresize=function(){e.myChart.resize()},t.next=23;break;case 11:if(!e.pie){t.next=20;break}return e.pieChart.showLoading({text:"正在加载数据"}),t.next=15,e.generateLegend();case 15:e.pieChart.setOption(e.pieOption,!0),e.pieChart.on("legendselectchanged",function(e){n.generateIndex(e.selected)}),window.onresize=function(){e.pieChart.resize()},t.next=23;break;case 20:if(!e.line){t.next=23;break}return t.next=23,e.drawLineGraph();case 23:e.graphResize(),e.loading||(e.myChart.hideLoading(),e.pieChart.hideLoading());case 25:case"end":return t.stop()}},t,e)}))()},drawLineGraph:function(){var e=this;return o()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.generateLegend();case 2:return console.log(e.lineOption),e.lineChart.setOption(e.lineOption,!0),e.lineChart.on("legendselectchanged",function(t){e.generateIndex(t.selected)}),window.onresize=function(){e.lineChart.resize()},t.next=8,e.lineChart.resize();case 8:case"end":return t.stop()}},t,e)}))()},generateIndex:function(e){var t=this.selectType,n=this.nameList[t],i=this.checkedGroup[t],a=[],r=e;if(this.pie)switch(t){case"all":-1!==i.indexOf(6)&&a.push(6),-1!==i.indexOf(7)&&a.push(7);break;case"video_count":-1!==i.indexOf(0)&&a.push(0),-1!==i.indexOf(5)&&a.push(5);break;case"audio_count":-1!==i.indexOf(0)&&a.push(0),-1!==i.indexOf(3)&&a.push(3),-1!==i.indexOf(4)&&a.push(4);break;case"im_count":-1!==i.indexOf(0)&&a.push(0)}for(var o=0;o<n.length;o++)r[n[o]]&&a.push(o);a.sort(this.compare),this.checkedGroup[t]=a},generateLegend:function(){var e=this;return o()(a.a.mark(function t(){var n,i,r,o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(n=e.selectType,i=e.nameList[n],r=e.checkedGroup[n],o=e.legendList[n],s=0;s<i.length;s++)o[i[s]]=-1!==r.indexOf(s);e.legendList[n]=o;case 6:case"end":return t.stop()}},t,e)}))()},compare:function(e,t){return e-t},graphResize:function(){var e=void 0;switch(this.graphType){case"bar":e=this.myChart;break;case"pie":e=this.pieChart;break;case"line":e=this.lineChart}setTimeout(function(){e.resize()},50)},dateReform:function(e){var t=e.slice(0,4)+"/"+e.slice(4,6);return e.length>6&&(t+="/"+e.slice(6,8)),t},formSeries:function(e){return{all:[{name:"通话",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.talkCount})},{name:"视频业务",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.videoAllCount})},{name:"一键告警",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.sosCount})},{name:"照片回传",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.photoUploadCount})},{name:"即时消息",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.imCount})},{name:"临时组创建",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.tmpGroupCount})},{name:"在线时长",type:"line",yAxisIndex:1,data:e.map(function(e){return e.onlineDuration})},{name:"里程",type:"line",yAxisIndex:2,data:e.map(function(e){return e.mileage})}],video_count:[{name:"视频业务总计",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.videoAllCount})},{name:"通话次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.videoCallCount})},{name:"回传次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.videoUploadCount})},{name:"点名次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.videoRollcallCount})},{name:"会商次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.videoConfCount})},{name:"总时长",type:"line",yAxisIndex:1,data:e.map(function(e){return e.videoDuration})}],audio_count:[{name:"通话总次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.talkCount})},{name:"群组通话次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.groupTalkCount})},{name:"个人通话次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.individualTalkCount})},{name:"群组通话时长",type:"line",yAxisIndex:1,data:e.map(function(e){return e.groupTalkDuration})},{name:"个人通话时长",type:"line",yAxisIndex:1,data:e.map(function(e){return e.individualTalkDuration})}],im_count:[{name:"即时消息总次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.imCount})},{name:"群组消息次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.groupImCount})},{name:"个人消息次数",type:"bar",yAxisIndex:0,data:e.map(function(e){return e.individualImCount})}]}}}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Row",[n("Row",{directives:[{name:"show",rawName:"v-show",value:e.searchShow||!e.fullscreen,expression:"searchShow||!fullscreen"}],staticStyle:{"margin-bottom":"15px","margin-top":"5px"}},[n("RadioGroup",{attrs:{type:"button",size:"small"},model:{value:e.graphType,callback:function(t){e.graphType=t},expression:"graphType"}},[n("Radio",{attrs:{label:"pie"}},[n("Icon",{attrs:{type:"md-pie"}})],1),e._v(" "),n("Radio",{attrs:{label:"bar"}},[n("Icon",{attrs:{type:"md-podium"}})],1),e._v(" "),n("Radio",{attrs:{label:"line"}},[n("Icon",{attrs:{type:"md-pulse"}})],1)],1),e._v(" "),n("Page",{directives:[{name:"show",rawName:"v-show",value:(e.pie||e.line)&&e.data.length>1,expression:"(pie||line)&&data.length>1"}],staticStyle:{float:"right"},attrs:{size:"small","page-size":1,current:e.currentPage,total:e.total,simple:""},on:{"update:current":function(t){e.currentPage=t}}})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.bar,expression:"bar"}],style:{height:e.graphHeight+"px"},attrs:{id:"chart"}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.pie,expression:"pie"}],style:{height:e.graphHeight+"px"},attrs:{id:"pieChart"}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.line,expression:"line"}],style:{height:e.graphHeight+"px"},attrs:{id:"lineChart"}})],1)],1)},staticRenderFns:[]};var y=n("VU/8")(f,g,!1,function(e){n("73Di")},"data-v-506360b0",null);t.a=y.exports}});