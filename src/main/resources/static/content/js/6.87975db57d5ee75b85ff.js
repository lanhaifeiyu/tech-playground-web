webpackJsonp([6],{djSP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("mvHQ"),o=n.n(s),a=n("Dd8w"),c=n.n(a),i=n("NYxO"),d={mounted:function(){this.$store.commit("changeName","屏蔽配置"),this.$store.dispatch("checkForDisable"),this.departments.length<1&&this.initialData()},computed:c()({checkedNodes:{get:function(){return this.$store.state.disableNodes},set:function(e){this.$store.commit("changeDisableNodes",e)}},departments:{get:function(){return this.$store.state.disableDeptTree},set:function(e){this.$store.commit("changeDisableTree",e)}}},Object(i.b)(["contentHeight","treeHeight","color"])),methods:{checkChange:function(e){this.checkedNodes.length<e.length?this.checkedNodes=e:(this.checkDelete(),this.checkAdd(e))},checkDelete:function(){for(var e=0;e<this.checkedNodes.length;e++)if(!1===this.checkedNodes[e].checked){this.checkedNodes.splice(e,1);break}},checkAdd:function(e){for(var t=0;t<e.length;t++)if(!this.isInArray(this.checkedNodes,e[t])){this.checkedNodes.push(e[t]);break}},handleClose:function(e,t){e.checked=!1,this.checkedNodes.splice(t,1)},loadTreeData:function(e,t){var n=this,s=[];this.$axios({method:"get",headers:{Authorization:"Bearer "+sessionStorage.getItem("token")},url:this.$host+"/dept/base",params:{dept_id:e.id,dept_chain:2,count:1e3,page:1}}).then(function(e){if(console.log(e),e.data.success){for(var o=0;o<e.data.data.length;o++){var a={title:e.data.data[o].dept_name,loading:!1,id:e.data.data[o].dept_id,children:[]};a.checked=n.isInArray(n.checkedNodes,a),s.push(a)}t(s)}else n.$Message.warning({content:"服务器繁忙，请稍后再试"})}).catch(function(e){console.log(e)})},initialData:function(){var e=this;this.departments=[],this.$axios({method:"get",headers:{Authorization:"Bearer "+sessionStorage.getItem("token")},url:this.$host+"/dept/base",params:{dept_id:sessionStorage.getItem("deptId"),dept_chain:0,count:1,page:1}}).then(function(t){if(console.log(t),t.data.success){var n={title:t.data.data[0].dept_name,loading:!1,id:t.data.data[0].dept_id,children:[]};n.checked=e.isInArray(e.checkedNodes,n),e.departments=[n]}else e.$Message.warning({content:"服务器繁忙，请稍后再试"})}).catch(function(e){console.log(e)})},isInArray:function(e,t){for(var n=0;n<e.length;n++)if(t.id===e[n].id)return e[n]=t,!0;return!1}},watch:{checkedNodes:function(e){localStorage.setItem(sessionStorage.getItem("uid")+"disableList",o()(e))}}},r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Content",{style:{padding:"10px 20px 10px",minHeight:e.contentHeight+"px",background:e.color.content}},[n("Row",[n("Col",{attrs:{span:"10"}},[n("Card",{style:{width:"90%",background:e.color.card},attrs:{bordered:!1}},[n("p",{style:{color:e.color.text},attrs:{slot:"title"},slot:"title"},[n("Icon",{attrs:{type:"md-list"}}),e._v("\n          部门树形结构\n        ")],1),e._v(" "),n("a",{attrs:{slot:"extra",href:"#"},slot:"extra"},[n("Tooltip",{attrs:{content:"其他树形表将在刷新后更新"}},[n("Icon",{attrs:{type:"md-help"}})],1)],1),e._v(" "),n("p",{style:{margin:"0px 0px 13px 0px",color:e.color.highlight}},[e._v("\n          请勾选需要屏蔽统计数据的部门\n        ")]),e._v(" "),n("div",{staticClass:"tree"},[n("Tree",{ref:"tree1",style:{maxHeight:e.contentHeight-180+"px"},attrs:{data:e.departments,"load-data":e.loadTreeData,"show-checkbox":"","check-directly":"","check-strictly":""},on:{"on-check-change":e.checkChange}})],1)])],1),e._v(" "),n("Col",{attrs:{span:"14"}},[n("p",{style:{color:e.color.contentHighlight}},[e._v("将屏蔽的部门如下：")]),e._v(" "),e._l(e.checkedNodes,function(t,s){return n("Tag",{key:t.nodeKey,staticStyle:{width:"280px"},attrs:{name:t.id,closable:""},on:{"on-close":function(n){return e.handleClose(t,s)}}},[e._v(e._s(t.title))])})],2)],1)],1)},staticRenderFns:[]};var h=n("VU/8")(d,r,!1,function(e){n("k6nn")},null,null);t.default=h.exports},k6nn:function(e,t){}});